import{_ as a,c as s,b as e,o as t}from"./app-DN8h5UIX.js";const l={};function i(p,n){return t(),s("div",null,n[0]||(n[0]=[e(`<h2 id="check-version" tabindex="-1"><a class="header-anchor" href="#check-version"><span>check version</span></a></h2><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token function">cat</span> /etc/os-release</span>
<span class="line"></span>
<span class="line"><span class="token assign-left variable">PRETTY_NAME</span><span class="token operator">=</span><span class="token string">&quot;Kali GNU/Linux Rolling&quot;</span></span>
<span class="line"><span class="token assign-left variable">NAME</span><span class="token operator">=</span><span class="token string">&quot;Kali GNU/Linux&quot;</span></span>
<span class="line"><span class="token assign-left variable">VERSION_ID</span><span class="token operator">=</span><span class="token string">&quot;2024.3&quot;</span></span>
<span class="line"><span class="token assign-left variable">VERSION</span><span class="token operator">=</span><span class="token string">&quot;2024.3&quot;</span></span>
<span class="line"><span class="token assign-left variable">VERSION_CODENAME</span><span class="token operator">=</span>kali-rolling</span>
<span class="line"><span class="token assign-left variable">ID</span><span class="token operator">=</span>kali</span>
<span class="line"><span class="token assign-left variable">ID_LIKE</span><span class="token operator">=</span>debian</span>
<span class="line"><span class="token assign-left variable">HOME_URL</span><span class="token operator">=</span><span class="token string">&quot;https://www.kali.org/&quot;</span></span>
<span class="line"><span class="token assign-left variable">SUPPORT_URL</span><span class="token operator">=</span><span class="token string">&quot;https://forums.kali.org/&quot;</span></span>
<span class="line"><span class="token assign-left variable">BUG_REPORT_URL</span><span class="token operator">=</span><span class="token string">&quot;https://bugs.kali.org/&quot;</span></span>
<span class="line"><span class="token assign-left variable">ANSI_COLOR</span><span class="token operator">=</span><span class="token string">&quot;1;31&quot;</span></span>
<span class="line"></span>
<span class="line"><span class="token function">uname</span> <span class="token parameter variable">-r</span></span>
<span class="line"><span class="token number">6.8</span>.11-arm64</span>
<span class="line"></span>
<span class="line"><span class="token function">uname</span> <span class="token parameter variable">-m</span></span>
<span class="line">aarch64</span>
<span class="line"></span>
<span class="line">lsb_release <span class="token parameter variable">-a</span></span>
<span class="line"></span>
<span class="line">No LSB modules are available.</span>
<span class="line">Distributor ID: Kali</span>
<span class="line">Description:    Kali GNU/Linux Rolling</span>
<span class="line">Release:        <span class="token number">2024.3</span></span>
<span class="line">Codename:       kali-rolling</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><table data-start="1273" data-end="1607"><thead data-start="1273" data-end="1294"><tr data-start="1273" data-end="1294"><th data-start="1273" data-end="1283">Command</th><th data-start="1283" data-end="1294">Purpose</th></tr></thead><tbody data-start="1317" data-end="1607"><tr data-start="1317" data-end="1372"><td><code data-start="1319" data-end="1340">cat /etc/os-release</code></td><td>Show <strong data-start="1348" data-end="1370">Kali Linux version</strong></td></tr><tr data-start="1373" data-end="1413"><td><code data-start="1375" data-end="1385">uname -r</code></td><td>Show <strong data-start="1393" data-end="1411">kernel version</strong></td></tr><tr data-start="1414" data-end="1466"><td><code data-start="1416" data-end="1432">lsb_release -a</code></td><td>Show <strong data-start="1440" data-end="1464">distribution details</strong></td></tr><tr data-start="1467" data-end="1531"><td><code data-start="1469" data-end="1479">uname -m</code></td><td>Show <strong data-start="1487" data-end="1510">system architecture</strong> (32-bit or 64-bit)</td></tr><tr data-start="1532" data-end="1607"><td>\`dpkg-query -W</td><td>grep kali\`</td></tr></tbody></table><h2 id="prepare" tabindex="-1"><a class="header-anchor" href="#prepare"><span>Prepare</span></a></h2><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token function">sudo</span> <span class="token function">apt</span> update</span>
<span class="line"><span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> can-utils python3 python3-pip</span>
<span class="line"></span>
<span class="line"><span class="token comment"># not work</span></span>
<span class="line"><span class="token comment"># pip install pycryptodome</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># work</span></span>
<span class="line"><span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> python3-pycryptodome</span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="set-up-virtual-can-interface" tabindex="-1"><a class="header-anchor" href="#set-up-virtual-can-interface"><span>Set up Virtual CAN interface</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token function">sudo</span> modprobe</span>
<span class="line">vcan <span class="token function">sudo</span> <span class="token function">ip</span> <span class="token function">link</span> <span class="token function">add</span> dev vcan0 <span class="token builtin class-name">type</span> vcan</span>
<span class="line"><span class="token function">sudo</span> <span class="token function">ip</span> <span class="token function">link</span> <span class="token builtin class-name">set</span> up vcan0</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><code>modprobe</code> loads kernel modules.</li><li><code>vcan</code> is the virtual CAN module, which allows you to create software-based CAN interfaces for testing.</li><li>This does not create a CAN interface; it just enables the vcan functionality.</li></ul><h2 id="replay-attack-without-security" tabindex="-1"><a class="header-anchor" href="#replay-attack-without-security"><span>Replay Attack (Without Security)</span></a></h2><h3 id="simulate-a-mock-ecu-sending-messages" tabindex="-1"><a class="header-anchor" href="#simulate-a-mock-ecu-sending-messages"><span>Simulate a Mock ECU Sending Messages</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">cangen vcan0 <span class="token parameter variable">-I</span> <span class="token number">123</span> <span class="token parameter variable">-L</span> <span class="token number">8</span> <span class="token parameter variable">-D</span> <span class="token number">1122334455667788</span> <span class="token parameter variable">-v</span> <span class="token parameter variable">-g</span> <span class="token number">100</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># Generate Random Data</span></span>
<span class="line">cangen vcan0 <span class="token parameter variable">-I</span> <span class="token number">123</span> <span class="token parameter variable">-L</span> <span class="token number">8</span> <span class="token parameter variable">-v</span> <span class="token parameter variable">-g</span> <span class="token number">100</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># Generate Incremental Data</span></span>
<span class="line">cangen vcan0 <span class="token parameter variable">-I</span> <span class="token number">123</span> <span class="token parameter variable">-L</span> <span class="token number">8</span> <span class="token parameter variable">-D</span> i <span class="token parameter variable">-v</span> <span class="token parameter variable">-g</span> <span class="token number">100</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># Send Messages Faster (Reduce Delay)</span></span>
<span class="line">cangen vcan0 <span class="token parameter variable">-I</span> <span class="token number">123</span> <span class="token parameter variable">-L</span> <span class="token number">8</span> <span class="token parameter variable">-D</span> <span class="token number">1122334455667788</span> <span class="token parameter variable">-v</span> <span class="token parameter variable">-g</span> <span class="token number">10</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># Limit the Number of Messages</span></span>
<span class="line"><span class="token comment"># Sends only 10 messages, then stops.</span></span>
<span class="line">cangen vcan0 <span class="token parameter variable">-I</span> <span class="token number">123</span> <span class="token parameter variable">-L</span> <span class="token number">8</span> <span class="token parameter variable">-D</span> <span class="token number">1122334455667788</span> <span class="token parameter variable">-v</span> <span class="token parameter variable">-g</span> <span class="token number">100</span> <span class="token parameter variable">-n</span> <span class="token number">10</span></span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><table data-start="207" data-end="602"><thead data-start="207" data-end="227"><tr data-start="207" data-end="227"><th data-start="207" data-end="216">Option</th><th data-start="216" data-end="227">Meaning</th></tr></thead><tbody data-start="249" data-end="602"><tr data-start="249" data-end="301"><td><code data-start="251" data-end="265">cangen vcan0</code></td><td>Sends CAN frames on <strong data-start="288" data-end="299"><code data-start="290" data-end="297">vcan0</code></strong></td></tr><tr data-start="302" data-end="346"><td><code data-start="304" data-end="312">-I 123</code></td><td>Uses <strong data-start="320" data-end="338">CAN ID <code data-start="329" data-end="336">0x123</code></strong> (hex)</td></tr><tr data-start="347" data-end="395"><td><code data-start="349" data-end="355">-L 8</code></td><td>Sets <strong data-start="363" data-end="378">data length</strong> to <strong data-start="382" data-end="393">8 bytes</strong></td></tr><tr data-start="396" data-end="486"><td><code data-start="398" data-end="419">-D 1122334455667788</code></td><td>Uses <strong data-start="427" data-end="449">fixed data payload</strong> (<code data-start="451" data-end="476">11 22 33 44 55 66 77 88</code> in hex)</td></tr><tr data-start="487" data-end="545"><td><code data-start="489" data-end="493">-v</code></td><td>Enables <strong data-start="504" data-end="522">verbose output</strong> (prints sent frames)</td></tr><tr data-start="546" data-end="602"><td><code data-start="548" data-end="556">-g 100</code></td><td><strong data-start="559" data-end="575">100 ms delay</strong> between sending messages</td></tr></tbody></table><h3 id="expected-output" tabindex="-1"><a class="header-anchor" href="#expected-output"><span>Expected Output</span></a></h3><div class="language-css line-numbers-mode" data-highlighter="prismjs" data-ext="css" data-title="css"><pre><code><span class="line">vcan0  123   [8]  11 22 33 44 55 66 77 88</span>
<span class="line">vcan0  123   [8]  11 22 33 44 55 66 77 88</span>
<span class="line">vcan0  123   [8]  11 22 33 44 55 66 77 88</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>explain</p><ul><li><code>vcan0</code> → Interface</li><li><code>123</code> → CAN ID (<code>0x123</code> in hex)</li><li><code>[8]</code> → Data length (DLC)</li><li><code>11 22 33 44 55 66 77 88</code> → Payload</li></ul><h3 id="monitor-message" tabindex="-1"><a class="header-anchor" href="#monitor-message"><span>Monitor Message</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">candump vcan0</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="summary" tabindex="-1"><a class="header-anchor" href="#summary"><span>Summary</span></a></h3><table data-start="1871" data-end="2297"><thead data-start="1871" data-end="1892"><tr data-start="1871" data-end="1892"><th data-start="1871" data-end="1881">Command</th><th data-start="1881" data-end="1892">Purpose</th></tr></thead><tbody data-start="1915" data-end="2297"><tr data-start="1915" data-end="2019"><td><code data-start="1917" data-end="1973">cangen vcan0 -I 123 -L 8 -D 1122334455667788 -v -g 100</code></td><td>Send <strong data-start="1981" data-end="1990">fixed</strong> CAN frames every <strong data-start="2008" data-end="2017">100ms</strong></td></tr><tr data-start="2020" data-end="2105"><td><code data-start="2022" data-end="2058">cangen vcan0 -I 123 -L 8 -v -g 100</code></td><td>Send <strong data-start="2066" data-end="2076">random</strong> CAN frames every <strong data-start="2094" data-end="2103">100ms</strong></td></tr><tr data-start="2106" data-end="2185"><td><code data-start="2108" data-end="2149">cangen vcan0 -I 123 -L 8 -D i -v -g 100</code></td><td>Send <strong data-start="2157" data-end="2172">incremental</strong> CAN frames</td></tr><tr data-start="2186" data-end="2254"><td><code data-start="2188" data-end="2223">cangen vcan0 -I 123 -L 8 -v -g 10</code></td><td>Send frames <strong data-start="2238" data-end="2252">every 10ms</strong></td></tr><tr data-start="2255" data-end="2297"><td><code data-start="2257" data-end="2272">candump vcan0</code></td><td>Capture CAN messages</td></tr></tbody></table><h2 id="capture-and-log-messages" tabindex="-1"><a class="header-anchor" href="#capture-and-log-messages"><span>Capture and Log Messages</span></a></h2><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">candump vcan0 <span class="token operator">&gt;</span> captured_can_log.txt</span>
<span class="line"></span>
<span class="line"><span class="token function">cat</span> captured_can_log.txt</span>
<span class="line">  vcan0  <span class="token number">123</span>   <span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span>  <span class="token number">11</span> <span class="token number">22</span> <span class="token number">33</span> <span class="token number">44</span> <span class="token number">55</span> <span class="token number">66</span> <span class="token number">77</span> <span class="token number">88</span></span>
<span class="line">  vcan0  <span class="token number">123</span>   <span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span>  <span class="token number">11</span> <span class="token number">22</span> <span class="token number">33</span> <span class="token number">44</span> <span class="token number">55</span> <span class="token number">66</span> <span class="token number">77</span> <span class="token number">88</span></span>
<span class="line">  vcan0  <span class="token number">123</span>   <span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span>  <span class="token number">11</span> <span class="token number">22</span> <span class="token number">33</span> <span class="token number">44</span> <span class="token number">55</span> <span class="token number">66</span> <span class="token number">77</span> <span class="token number">88</span></span>
<span class="line">  vcan0  <span class="token number">123</span>   <span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span>  <span class="token number">11</span> <span class="token number">22</span> <span class="token number">33</span> <span class="token number">44</span> <span class="token number">55</span> <span class="token number">66</span> <span class="token number">77</span> <span class="token number">88</span></span>
<span class="line">  vcan0  <span class="token number">123</span>   <span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span>  <span class="token number">11</span> <span class="token number">22</span> <span class="token number">33</span> <span class="token number">44</span> <span class="token number">55</span> <span class="token number">66</span> <span class="token number">77</span> <span class="token number">88</span></span>
<span class="line">  <span class="token punctuation">..</span>.</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">candump <span class="token parameter variable">-l</span> vcan0 <span class="token operator">&gt;</span> captured_can_log.txt</span>
<span class="line"></span>
<span class="line"><span class="token function">cat</span> candump-2025-03-02_104339.log</span>
<span class="line"><span class="token punctuation">(</span><span class="token number">1740930219.186591</span><span class="token punctuation">)</span> vcan0 <span class="token number">123</span><span class="token comment">#1122334455667788</span></span>
<span class="line"><span class="token punctuation">(</span><span class="token number">1740930219.287877</span><span class="token punctuation">)</span> vcan0 <span class="token number">123</span><span class="token comment">#1122334455667788</span></span>
<span class="line"><span class="token punctuation">(</span><span class="token number">1740930219.388586</span><span class="token punctuation">)</span> vcan0 <span class="token number">123</span><span class="token comment">#1122334455667788</span></span>
<span class="line"><span class="token punctuation">(</span><span class="token number">1740930219.489370</span><span class="token punctuation">)</span> vcan0 <span class="token number">123</span><span class="token comment">#1122334455667788</span></span>
<span class="line"><span class="token punctuation">(</span><span class="token number">1740930219.593078</span><span class="token punctuation">)</span> vcan0 <span class="token number">123</span><span class="token comment">#1122334455667788</span></span>
<span class="line"><span class="token punctuation">(</span><span class="token number">1740930219.695327</span><span class="token punctuation">)</span> vcan0 <span class="token number">123</span><span class="token comment">#1122334455667788</span></span>
<span class="line"><span class="token punctuation">..</span>.</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="python-environment" tabindex="-1"><a class="header-anchor" href="#python-environment"><span>Python Environment</span></a></h3><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">$ python3 receive_secoc_can.py </span>
<span class="line">Traceback (most recent call last):</span>
<span class="line">  File &quot;/home/parallels/Documents/Test/lab3/receive_secoc_can.py&quot;, line 5, in &lt;module&gt;</span>
<span class="line">    from Crypto.Cipher import AES</span>
<span class="line">ModuleNotFoundError: No module named &#39;Crypto&#39;</span>
<span class="line">                                                                                                                                           </span>
<span class="line">$ pip install pycryptodome</span>
<span class="line"></span>
<span class="line">error: externally-managed-environment</span>
<span class="line"></span>
<span class="line">× This environment is externally managed</span>
<span class="line">╰─&gt; To install Python packages system-wide, try apt install</span>
<span class="line">    python3-xyz, where xyz is the package you are trying to</span>
<span class="line">    install.</span>
<span class="line">    </span>
<span class="line">    If you wish to install a non-Debian-packaged Python package,</span>
<span class="line">    create a virtual environment using python3 -m venv path/to/venv.</span>
<span class="line">    Then use path/to/venv/bin/python and path/to/venv/bin/pip. Make</span>
<span class="line">    sure you have python3-full installed.</span>
<span class="line">    </span>
<span class="line">    If you wish to install a non-Debian packaged Python application,</span>
<span class="line">    it may be easiest to use pipx install xyz, which will manage a</span>
<span class="line">    virtual environment for you. Make sure you have pipx installed.</span>
<span class="line">    </span>
<span class="line">    See /usr/share/doc/python3.13/README.venv for more information.</span>
<span class="line"></span>
<span class="line">note: If you believe this is a mistake, please contact your Python installation or OS distribution provider. You can override this, at the risk of breaking your Python installation or OS, by passing --break-system-packages.</span>
<span class="line">hint: See PEP 668 for the detailed specification.</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="check" tabindex="-1"><a class="header-anchor" href="#check"><span>Check</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">dpkg <span class="token parameter variable">-L</span> python3-pycryptodome <span class="token operator">|</span> <span class="token function">grep</span> Crypto</span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="env" tabindex="-1"><a class="header-anchor" href="#env"><span>Env</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token function">sudo</span> <span class="token function">apt</span> update</span>
<span class="line"><span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> python3-venv</span>
<span class="line"></span>
<span class="line"><span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> python3.13-venv</span>
<span class="line"></span>
<span class="line">python3 <span class="token parameter variable">-m</span> venv <span class="token parameter variable">--help</span></span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token comment"># create env</span></span>
<span class="line">python3 <span class="token parameter variable">-m</span> venv myenv</span>
<span class="line"></span>
<span class="line"><span class="token builtin class-name">source</span> myenv/bin/activate</span>
<span class="line"><span class="token builtin class-name">source</span> ~/myenv/bin/activate</span>
<span class="line"></span>
<span class="line">pip <span class="token function">install</span> pycryptodome</span>
<span class="line">pip <span class="token function">install</span> python-can</span>
<span class="line"></span>
<span class="line"></span>
<span class="line">python3 <span class="token parameter variable">-c</span> <span class="token string">&quot;from Cryptodome.Util.Padding import pad, unpad; print(&#39;PyCryptodome installed!&#39;)&quot;</span></span>
<span class="line"></span>
<span class="line">pip list <span class="token operator">|</span> <span class="token function">grep</span> pycryptodome</span>
<span class="line"></span>
<span class="line">python3 <span class="token parameter variable">-m</span> pip show pycryptodome</span>
<span class="line">Name: pycryptodome</span>
<span class="line">Version: <span class="token number">3.21</span>.0</span>
<span class="line">Summary: Cryptographic library <span class="token keyword">for</span> Python</span>
<span class="line">Home-page: https://www.pycryptodome.org</span>
<span class="line">Author: Helder Eijs</span>
<span class="line">Author-email: helderijs@gmail.com</span>
<span class="line">License: BSD, Public Domain</span>
<span class="line">Location: /home/parallels/myenv/lib/python3.13/site-packages</span>
<span class="line">Requires: </span>
<span class="line">Required-by: </span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="check-pad-function" tabindex="-1"><a class="header-anchor" href="#check-pad-function"><span>check pad function</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token builtin class-name">pwd</span></span>
<span class="line">/home/parallels/myenv/lib/python3.13/site-packages/Crypto/Util</span>
<span class="line"></span>
<span class="line"><span class="token function">ls</span></span>
<span class="line">asn1.py      _cpu_features.py   _file_system.pyi  Padding.py     __pycache__   RFC1751.pyi</span>
<span class="line">asn1.pyi     _cpu_features.pyi  __init__.py       Padding.pyi    _raw_api.py   _strxor.abi3.so</span>
<span class="line">Counter.py   _cpuid_c.abi3.so   number.py         py3compat.py   _raw_api.pyi  strxor.py</span>
<span class="line">Counter.pyi  _file_system.py    number.pyi        py3compat.pyi  RFC1751.py    strxor.pyi</span>
<span class="line"></span>
<span class="line"></span>
<span class="line">$ <span class="token function">grep</span> <span class="token string">&#39;def pad&#39;</span> Padding.py</span>
<span class="line">def pad<span class="token punctuation">(</span>data_to_pad, block_size, <span class="token assign-left variable">style</span><span class="token operator">=</span><span class="token string">&#39;pkcs7&#39;</span><span class="token punctuation">)</span>:</span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="add-vcan" tabindex="-1"><a class="header-anchor" href="#add-vcan"><span>Add VCan</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token function">sudo</span> <span class="token function">ip</span> <span class="token function">link</span> <span class="token builtin class-name">set</span> vcan0 down</span>
<span class="line"><span class="token function">sudo</span> <span class="token function">ip</span> <span class="token function">link</span> <span class="token builtin class-name">set</span> vcan0 up</span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span class="token function">sudo</span> <span class="token function">ip</span> <span class="token function">link</span> delete vcan0 <span class="token builtin class-name">type</span> vcan</span>
<span class="line"><span class="token function">sudo</span> <span class="token function">ip</span> <span class="token function">link</span> <span class="token function">add</span> dev vcan0 <span class="token builtin class-name">type</span> vcan</span>
<span class="line"><span class="token function">sudo</span> <span class="token function">ip</span> <span class="token function">link</span> <span class="token builtin class-name">set</span> up vcan0</span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span class="token function">ip</span> <span class="token parameter variable">-details</span> <span class="token parameter variable">-statistics</span> <span class="token function">link</span> show vcan0</span>
<span class="line"></span>
<span class="line"><span class="token function">ip</span> <span class="token function">link</span> show <span class="token builtin class-name">type</span> can</span>
<span class="line"></span>
<span class="line"><span class="token comment"># check Can</span></span>
<span class="line">python3 <span class="token parameter variable">-c</span> <span class="token string">&quot;import can; can.Bus(channel=&#39;vcan0&#39;, interface=&#39;socketcan&#39;).shutdown()&quot;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="debug" tabindex="-1"><a class="header-anchor" href="#debug"><span>Debug</span></a></h2><p>Issue in send_secop_can.py The error &quot;OSError: [Errno 22] Invalid argument&quot; occurs because CAN frames are limited to a maximum of 8 bytes of data, but your script is trying to send 16 bytes.</p>`,36)]))}const d=a(l,[["render",i],["__file","Can.html.vue"]]),r=JSON.parse('{"path":"/Env/Can.html","title":"CAN Debug","lang":"zh-CN","frontmatter":{"lang":"zh-CN","title":"CAN Debug","description":"some description"},"headers":[{"level":2,"title":"check version","slug":"check-version","link":"#check-version","children":[]},{"level":2,"title":"Prepare","slug":"prepare","link":"#prepare","children":[{"level":3,"title":"Set up Virtual CAN interface","slug":"set-up-virtual-can-interface","link":"#set-up-virtual-can-interface","children":[]}]},{"level":2,"title":"Replay Attack (Without Security)","slug":"replay-attack-without-security","link":"#replay-attack-without-security","children":[{"level":3,"title":"Simulate a Mock ECU Sending Messages","slug":"simulate-a-mock-ecu-sending-messages","link":"#simulate-a-mock-ecu-sending-messages","children":[]},{"level":3,"title":"Expected Output","slug":"expected-output","link":"#expected-output","children":[]},{"level":3,"title":"Monitor Message","slug":"monitor-message","link":"#monitor-message","children":[]},{"level":3,"title":"Summary","slug":"summary","link":"#summary","children":[]}]},{"level":2,"title":"Capture and Log Messages","slug":"capture-and-log-messages","link":"#capture-and-log-messages","children":[{"level":3,"title":"Python Environment","slug":"python-environment","link":"#python-environment","children":[]},{"level":3,"title":"Check","slug":"check","link":"#check","children":[]},{"level":3,"title":"Env","slug":"env","link":"#env","children":[]},{"level":3,"title":"check pad function","slug":"check-pad-function","link":"#check-pad-function","children":[]},{"level":3,"title":"Add VCan","slug":"add-vcan","link":"#add-vcan","children":[]}]},{"level":2,"title":"Debug","slug":"debug","link":"#debug","children":[]}],"git":{"updatedTime":1740967256000},"filePathRelative":"Env/Can.md"}');export{d as comp,r as data};
